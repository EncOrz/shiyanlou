# 实现个税计算器

## 介绍

我们开发了一个个税计算器，输入工资后，打印应缴纳的个税。

个税计算公式：

1. 应纳税所得额 = 工资金额 － 各项社会保险费 - 起征点(3500元)
2. 纳税 = 应纳税所得额 × 税率 － 速算扣除数

其中各项社会保险费我们在本程序中设置为0即可，不用考虑。

税率及速算扣除数对应表：

| 应纳税所得额             | 税率 | 速算扣除数（元） |
| ------------------------ | ---- | ---------------- |
| 不超过 1500 元           | 3%   | 0                |
| 超过 1500 元至 4500 元   | 10%  | 105              |
| 超过 4500 元至 9000 元   | 20%  | 555              |
| 超过 9000 元至 35000 元  | 25%  | 1005             |
| 超过 35000 元至 55000 元 | 30%  | 2755             |
| 超过 55000 元至 80000 元 | 35%  | 5505             |
| 超过 80000 元            | 45%  | 13505            |

例如工资金额为 5000，那么减去起征点，应纳税所得额为 1500（5000-3500），纳税为 45 元（1500 * 3% - 0）。

程序使用 Python3 运行，执行过程和结果举例如下：

```shell
$ python3 /home/shiyanlou/calculator.py 3500
0.00
$ python3 /home/shiyanlou/calculator.py 5000
45.00
$ python3 /home/shiyanlou/calculator.py 15000
1870.00
```

需要注意，程序执行的参数只有一个，并且参数为工资金额，需要为整数，如果参数数量不准确或者无法转成整数，需要使用 print 打印错误信息，代码如下：

```shell
print("Parameter Error")
```

注意工资数额是作为命令行程序的参数的（`sys.argv` 获取），不要使用 `input`获取输入信息，否则挑战提交结果时会超时。

## 目标

完成任务需要达成的目标：

1. 程序存放的位置 `/home/shiyanlou/calculator.py`
2. 程序执行的第一个参数为工资金额，即程序执行方式为 `./calculator.py 3500`
3. 程序返回的数字保留两位小数，如果是整数，仍然需要保留`xxx.00` 这种形式。

## 提示语

1. 将参数转成整数可以使用 `int()` ，如果不能正确转成整数（例如 int('abcd')），需要处理异常并打印上面的错误信息。
2. 输出保留两位小数可以使用字符串的 format 函数格式化，例如 `format(1.2345, ".2f")` 得到的就是有两位小数的字符串 `'1.23'`
3. 命令行参数获取方法是使用 sys 模块的 `sys.argv`，**不要使用 input() 获取输入**，其中 `sys.argv[0]` 为脚本名称， `sys.argv[1]` 为第一个参数，示例：

```shell
import sys

print(sys.argv)
```

最后，因为后续的挑战将会用到现在写的代码，请使用 `下载代码` 保存到本地或者提交到自己的 Github。

## 注意

1. try except 判断异常的时候只需要包含可能出现异常的代码，比如将输入的字符串转换成 int 的时候，不需要包含所有的代码
2. 需要等到程序可以正常执行之后再增加异常处理代码，否则非常不利于调试
3. Python 中对每行的缩进要求严格，务必不要TAB与空格混用，建议使用空格来进行缩进，缩进使用4个空格。

## 解题

```python
import sys
##创建字典，记录税率及速算扣除数对应表
##key:0x1500 代表区间0~1500
##value:由数组[税率:速算扣除数]

tax_math = {"0x1500":[0.03,0],"1500x4500":[0.1,105],"4500x9000":[0.2,555],"9000x35000":[0.25,1005],"35000x55000":[0.3,2755],"55000x80000":[0.35,5505],"80000x":[0.45,13505]}

##定义计算方法(参数：应纳税所得额)，返回计算结果
def ptax_calculate(tax_num):
	##不超过3500，很惨，不考虑！
    if(tax_num<=0):
		return 0.00
	else:
		for k in tax_math.keys():
           ##我用x做范围区间，此时应该拆开了
			kk=k.split("x")
           ##首先考虑大佬，太有钱的要另外算，范围太大，没极限
			if(kk[1]==None):
				return (tax_num * tax_math[k][0]-tax_math[k][1])
			else:
               ##正常人开始，如 0x1500 ,(tax_num > 0 and tax_num <= 1500)
				if(tax_num > int(kk[0]) and tax_num <= int(kk[1])):
					return (tax_num * tax_math[k][0]-tax_math[k][1])
					break
				else:
					continue

try:
	salary = sys.argv[1]   ##第一个参数
	tax_num = int(salary) - 3500
	print(format(ptax_calculate(tax_num),".2f"))
    ##可以试错后看返回的异常类型，通过ValueError获取异常，
except ValueError as e:
	print("Parameter Error")
```

